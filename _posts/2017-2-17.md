---
layout: post
title: VBA 1ST TIME
---

```
Sub PIE()
'FIRST OF ALL WE NEED TO GENERATE NEW SHEET
    On Error Resume Next
    Worksheets.Add(Before:=Worksheets(1)).Name = "PIE CHART"
   
'IN THE FIRST SHEET WE WILL DRAW 6 PIE CHARTS BY PRODUCTS AND CLIENTS IN 3 YEARS/1 YEAR/1 MONTH
    Workbooks("file").Activate
    Worksheets("PIE CHART").Activate
    Set bbb = ActiveSheet.Shapes.AddChart2(251, xlPie)
    Set ab = Range("A3:G15")
    bbb.Select
    ActiveChart.SetSourceData Source:=Range("sheet1!$B$1:$B$5,sheet1!$D$1:$D$5")
    ActiveChart.ClearToMatchStyle
    ActiveChart.ChartStyle = 253
    ActiveChart.FullSeriesCollection(1).DataLabels.Select
    With Selection.Format.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
        .ForeColor.Brightness = 0
        .Transparency = 0
        .Solid
    End With
    Selection.ShowCategoryName = True
    Selection.Separator = "" & Chr(13) & ""
    Selection.Position = xlLabelPositionInsideEnd
    Selection.Format.Fill.Visible = msoFalse
    ActiveChart.ChartTitle.Select
    With Selection.Format.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(64, 82, 111)
        .Transparency = 0
        .Solid
    End With
    ActiveChart.ChartTitle.Text = "Pie Chart of Product Sales in 3 Years"
    Selection.Format.TextFrame2.TextRange.Characters.Text = _
        "Pie Chart of Product Sales in 3 Years"
    With Selection.Format.TextFrame2.TextRange.Characters(1, 37).ParagraphFormat
        .TextDirection = msoTextDirectionLeftToRight
        .Alignment = msoAlignCenter
    End With
    With Selection.Format.TextFrame2.TextRange.Characters(1, 37).Font
        .BaselineOffset = 0
        .Bold = msoTrue
        .NameComplexScript = "+mn-cs"
        .NameFarEast = "+mn-ea"
        .Fill.Visible = msoTrue
        .Fill.ForeColor.RGB = RGB(64, 82, 111)
        .Fill.Transparency = 0
        .Fill.Solid
        .Size = 17
        .Italic = msoFalse
        .Kerning = 12
        .Name = "+mn-lt"
        .UnderlineStyle = msoNoUnderline
        .Strike = msoNoStrike
    End With
    With bbb
        .Top = ab.Top
        .Left = ab.Left
        .Width = ab.Width
        .Height = ab.Height
    End With
   ```
